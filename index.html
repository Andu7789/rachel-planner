<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Adult Learning Course Planner</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <h1>Course Planner</h1>
            <div class="header-actions">
                <button id="btn-dashboard" class="btn btn-secondary">Dashboard</button>
                <button id="btn-tutors" class="btn btn-secondary">Tutors</button>
                <button id="btn-locations" class="btn btn-secondary">Locations</button>
                <button id="btn-courses" class="btn btn-secondary">Courses</button>
                <button id="btn-reports" class="btn btn-secondary">Reports</button>
                <button id="btn-export" class="btn btn-primary">Export</button>
            </div>
        </header>

        <!-- Main Content Area -->
        <main class="main-content">
            <!-- Dashboard View -->
            <section id="view-dashboard" class="view active">
                <div class="dashboard-grid">
                    <div class="dashboard-card">
                        <h2>Settings</h2>
                        <div class="form-group">
                            <label for="week1-start-date">Week 1 Start Date</label>
                            <input type="date" id="week1-start-date" class="input">
                            <p style="font-size: 0.85rem; color: var(--gray-600); margin-top: 0.5rem;">
                                Current Week: <strong id="current-week-display">Not Set</strong>
                            </p>
                        </div>
                        <div class="form-group">
                            <label for="funded-color">Funded Course Color</label>
                            <div style="display: flex; gap: 0.5rem; align-items: center;">
                                <input type="color" id="funded-color" class="input" style="width: 60px; height: 40px; padding: 2px;">
                                <span id="funded-color-preview" style="flex: 1; padding: 0.5rem; border-radius: 4px; border: 1px solid var(--gray-300);"></span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="non-funded-color">Non-Funded Course Color</label>
                            <div style="display: flex; gap: 0.5rem; align-items: center;">
                                <input type="color" id="non-funded-color" class="input" style="width: 60px; height: 40px; padding: 2px;">
                                <span id="non-funded-color-preview" style="flex: 1; padding: 0.5rem; border-radius: 4px; border: 1px solid var(--gray-300);"></span>
                            </div>
                        </div>
                    </div>
                    <div class="dashboard-card">
                        <h2>Quick Stats</h2>
                        <div class="stats-grid">
                            <div class="stat-item">
                                <span class="stat-value" id="stat-courses">0</span>
                                <span class="stat-label">Courses Scheduled</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value" id="stat-tutors">0</span>
                                <span class="stat-label">Active Tutors</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value" id="stat-locations">0</span>
                                <span class="stat-label">Locations</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value" id="stat-conflicts">0</span>
                                <span class="stat-label">Conflicts</span>
                            </div>
                        </div>
                    </div>

                    <div class="dashboard-card">
                        <h2>Upcoming This Week</h2>
                        <div id="upcoming-list" class="upcoming-list"></div>
                    </div>

                    <div class="dashboard-card">
                        <h2>Resource Utilization</h2>
                        <div id="utilization-chart" class="utilization-chart"></div>
                    </div>

                    <div class="dashboard-card">
                        <h2>Recent Conflicts</h2>
                        <div id="conflicts-list" class="conflicts-list"></div>
                    </div>
                </div>
            </section>

            <!-- Tutors View -->
            <section id="view-tutors" class="view">
                <div class="view-header">
                    <h2>Tutor Management</h2>
                    <button id="btn-add-tutor" class="btn btn-primary">Add Tutor</button>
                </div>
                <div class="tutors-grid" id="tutors-grid"></div>
            </section>

            <!-- Locations View -->
            <section id="view-locations" class="view">
                <div class="view-header">
                    <h2>Location Management</h2>
                    <button id="btn-add-location" class="btn btn-primary">Add Location</button>
                </div>
                <div class="locations-grid" id="locations-grid"></div>
            </section>

            <!-- Courses/Calendar View -->
            <section id="view-courses" class="view">
                <div class="view-header view-header-sticky">
                    <h2>Course Schedule</h2>
                    <div class="calendar-controls" style="flex-wrap: wrap; gap: 0.5rem;">
                        <input type="search" id="course-search" class="input" placeholder="üîç Search courses..." style="max-width: 200px;">
                        <select id="course-selector" class="select" style="min-width: 150px;">
                            <option value="">Select a course...</option>
                        </select>
                        <button id="btn-add-course" class="btn btn-primary">Add Course</button>
                        <div style="display: flex; align-items: center; gap: 0.5rem;">
                            <button id="btn-today" class="btn btn-secondary">Today</button>
                            <button id="btn-jump-to-week" class="btn btn-secondary">Jump to Week</button>
                            <button id="btn-prev-weeks" class="btn btn-icon">‚Üê</button>
                            <span id="week-range-display">Weeks 1-4</span>
                            <button id="btn-next-weeks" class="btn btn-icon">‚Üí</button>
                            <select id="view-mode-select" class="select">
                                <option value="week">Week View</option>
                                <option value="4weeks" selected>4 Weeks</option>
                                <option value="month">Month View</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="calendar-container">
                    <div id="calendar-grid" class="calendar-grid"></div>
                </div>
            </section>

            <!-- Reports View -->
            <section id="view-reports" class="view">
                <div class="view-header">
                    <h2>Reports</h2>
                    <div class="report-controls">
                        <select id="report-type-select" class="select">
                            <option value="tutor-schedule">Tutor Schedules</option>
                            <option value="tutor-workload">Tutor Workload (Hours per Week)</option>
                            <option value="location-utilization">Location Utilization</option>
                            <option value="course-list">Course List</option>
                            <option value="conflicts">Conflicts Report</option>
                            <option value="unavailable-resources">Courses with Unavailable Resources</option>
                        </select>
                        <button id="btn-generate-report" class="btn btn-primary">Generate</button>
                    </div>
                </div>
                <div id="report-content" class="report-content"></div>
            </section>
        </main>
    </div>

    <!-- Modal for Adding/Editing Tutor -->
    <div id="modal-tutor" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="tutor-modal-title">Add Tutor</h3>
                <button class="btn-close" data-modal="modal-tutor">&times;</button>
            </div>
            <div class="modal-body">
                <form id="form-tutor">
                    <input type="hidden" id="tutor-id">
                    <div class="form-group">
                        <label for="tutor-name">Name</label>
                        <input type="text" id="tutor-name" class="input" required>
                    </div>
                    <div class="form-group">
                        <label for="tutor-email">Email</label>
                        <input type="email" id="tutor-email" class="input">
                    </div>
                    <div class="form-group">
                        <label for="tutor-phone">Phone</label>
                        <input type="tel" id="tutor-phone" class="input">
                    </div>
                    <div class="form-group">
                        <label for="tutor-skills">Skills/Qualifications</label>
                        <input type="text" id="tutor-skills" class="input" placeholder="e.g., Art, Computing, Languages">
                    </div>
                    <div class="form-group">
                        <label>Recurring Availability</label>
                        <div id="tutor-recurring-availability" class="availability-grid"></div>
                    </div>
                    <div class="form-group">
                        <label>Custom Availability/Exceptions</label>
                        <button type="button" id="btn-add-custom-availability" class="btn btn-secondary btn-sm">Add Custom Period</button>
                        <div id="tutor-custom-availability" class="custom-availability-list"></div>
                    </div>
                    <div class="form-group">
                        <label>Can Teach (select courses this tutor is qualified to teach)</label>
                        <div id="tutor-can-teach" style="max-height: 200px; overflow-y: auto; border: 1px solid var(--gray-300); border-radius: 4px; padding: 0.5rem;"></div>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" data-modal="modal-tutor">Cancel</button>
                        <button type="submit" class="btn btn-primary">Save Tutor</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal for Adding/Editing Location -->
    <div id="modal-location" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="location-modal-title">Add Location</h3>
                <button class="btn-close" data-modal="modal-location">&times;</button>
            </div>
            <div class="modal-body">
                <form id="form-location">
                    <input type="hidden" id="location-id">
                    <div class="form-group">
                        <label for="location-name">Name</label>
                        <input type="text" id="location-name" class="input" required>
                    </div>
                    <div class="form-group">
                        <label for="location-capacity">Capacity</label>
                        <input type="number" id="location-capacity" class="input" min="1">
                    </div>
                    <div class="form-group">
                        <label for="location-facilities">Facilities</label>
                        <input type="text" id="location-facilities" class="input" placeholder="e.g., Projector, Computers, Art Supplies">
                    </div>
                    <div class="form-group">
                        <label>Recurring Availability</label>
                        <div id="location-recurring-availability" class="availability-grid"></div>
                    </div>
                    <div class="form-group">
                        <label>Custom Availability/Exceptions</label>
                        <button type="button" id="btn-add-custom-location-availability" class="btn btn-secondary btn-sm">Add Custom Period</button>
                        <div id="location-custom-availability" class="custom-availability-list"></div>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" data-modal="modal-location">Cancel</button>
                        <button type="submit" class="btn btn-primary">Save Location</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal for Adding/Editing Course -->
    <div id="modal-course" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="course-modal-title">Add Course</h3>
                <button class="btn-close" data-modal="modal-course">&times;</button>
            </div>
            <div class="modal-body">
                <form id="form-course">
                    <input type="hidden" id="course-id">
                    <div class="form-group">
                        <label for="course-name">Course Name</label>
                        <input type="text" id="course-name" class="input" required>
                    </div>
                    <div class="form-group">
                        <label for="course-color">Color</label>
                        <div style="display: flex; gap: 1rem; align-items: center;">
                            <input type="color" id="course-color" class="input" value="#4a90e2" style="width: 80px; height: 40px; cursor: pointer;">
                            <div id="color-preview" style="flex: 1; padding: 0.6rem; border-radius: 4px; border: 2px solid var(--gray-300); font-size: 0.85rem; font-weight: 500; text-align: center;">
                                Selected Color
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                            <input type="checkbox" id="course-funded" style="width: 20px; height: 20px; cursor: pointer;">
                            <span>Funded Course</span>
                        </label>
                    </div>
                    <div class="form-group">
                        <label for="course-tutor">Tutor</label>
                        <select id="course-tutor" class="select" required>
                            <option value="">Select Tutor</option>
                        </select>
                        <div id="tutor-availability-warning" class="availability-warning" style="display: none;"></div>
                    </div>
                    <div class="form-group">
                        <label for="course-location">Location</label>
                        <select id="course-location" class="select" required>
                            <option value="">Select Location</option>
                        </select>
                        <div id="location-availability-warning" class="availability-warning" style="display: none;"></div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="course-start-week">Start Week</label>
                            <input type="number" id="course-start-week" class="input" min="1" max="40" required>
                        </div>
                        <div class="form-group">
                            <label for="course-duration">Duration (weeks)</label>
                            <input type="number" id="course-duration" class="input" min="1" max="40" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Days of Week (select one or more)</label>
                        <div id="course-days-container" style="display: flex; gap: 1rem; flex-wrap: wrap; margin-top: 0.5rem;">
                            <label style="display: flex; align-items: center; gap: 0.3rem; cursor: pointer;">
                                <input type="checkbox" name="course-day" value="1" style="width: 18px; height: 18px; cursor: pointer;">
                                <span>Mon</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 0.3rem; cursor: pointer;">
                                <input type="checkbox" name="course-day" value="2" style="width: 18px; height: 18px; cursor: pointer;">
                                <span>Tue</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 0.3rem; cursor: pointer;">
                                <input type="checkbox" name="course-day" value="3" style="width: 18px; height: 18px; cursor: pointer;">
                                <span>Wed</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 0.3rem; cursor: pointer;">
                                <input type="checkbox" name="course-day" value="4" style="width: 18px; height: 18px; cursor: pointer;">
                                <span>Thu</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 0.3rem; cursor: pointer;">
                                <input type="checkbox" name="course-day" value="5" style="width: 18px; height: 18px; cursor: pointer;">
                                <span>Fri</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 0.3rem; cursor: pointer;">
                                <input type="checkbox" name="course-day" value="6" style="width: 18px; height: 18px; cursor: pointer;">
                                <span>Sat</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 0.3rem; cursor: pointer;">
                                <input type="checkbox" name="course-day" value="0" style="width: 18px; height: 18px; cursor: pointer;">
                                <span>Sun</span>
                            </label>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="course-start-time">Start Time</label>
                            <input type="time" id="course-start-time" class="input" required>
                        </div>
                        <div class="form-group">
                            <label for="course-end-time">End Time</label>
                            <input type="time" id="course-end-time" class="input" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="course-notes">Notes</label>
                        <textarea id="course-notes" class="input" rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Qualified Tutors (select tutors who can teach this course)</label>
                        <div id="course-qualified-tutors" style="max-height: 150px; overflow-y: auto; border: 1px solid var(--gray-300); border-radius: 4px; padding: 0.5rem;"></div>
                    </div>
                    <div id="course-conflicts-warning" class="availability-warning" style="display: none;"></div>
                    <div class="form-actions">
                        <div style="display: flex; gap: 0.5rem;">
                            <button type="button" id="btn-duplicate-course" class="btn btn-secondary" style="display: none;">üìã Duplicate</button>
                            <button type="button" id="btn-delete-course" class="btn btn-danger" style="display: none;">Delete Course</button>
                        </div>
                        <div style="display: flex; gap: 0.8rem;">
                            <button type="button" class="btn btn-secondary" data-modal="modal-course">Cancel</button>
                            <button type="submit" class="btn btn-primary">Save Course</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Export Modal -->
    <div id="modal-export" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Export Data</h3>
                <button class="btn-close" data-modal="modal-export">&times;</button>
            </div>
            <div class="modal-body">
                <div class="export-options">
                    <h4>Choose Export Format:</h4>
                    <button id="btn-export-pdf" class="btn btn-primary btn-block">Export to PDF</button>
                    <button id="btn-export-excel" class="btn btn-primary btn-block">Export to Excel</button>
                    <button id="btn-export-json" class="btn btn-secondary btn-block">Export Data (JSON)</button>

                    <h4 style="margin-top: 20px;">AI Optimization:</h4>
                    <button id="btn-export-ai" class="btn btn-primary btn-block" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">ü§ñ Export for AI Optimization</button>
                    <p style="font-size: 0.85em; color: var(--gray-600); margin-top: 0.5rem;">
                        Exports your data with all conflicts and constraints, plus an AI prompt.
                        Paste into Claude/ChatGPT to automatically fix scheduling issues.
                    </p>

                    <h4 style="margin-top: 20px;">Import Data:</h4>
                    <div style="display: flex; gap: 0.5rem;">
                        <button id="btn-paste-json" class="btn btn-primary" style="flex: 1;">üìã Paste JSON from AI</button>
                        <button id="btn-import-file" class="btn btn-secondary" style="flex: 1;">üìÅ Import File</button>
                    </div>
                    <input type="file" id="input-import-json" accept=".json" class="input" style="display: none;">
                    <button id="btn-undo-import" class="btn btn-secondary btn-block" style="margin-top: 0.5rem;">‚Ü©Ô∏è Undo Last Import</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for Pasting JSON -->
    <div id="modal-paste-json" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h3>Paste JSON from AI</h3>
                <button class="btn-close" data-modal="modal-paste-json">&times;</button>
            </div>
            <div class="modal-body">
                <p style="margin-bottom: 1rem; color: var(--gray-600);">
                    Paste the JSON that the AI returned. The system will automatically extract the JSON from code blocks.
                </p>
                <textarea id="paste-json-input" class="input" rows="15" placeholder='Paste the entire AI response here, or just the JSON part...'></textarea>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" data-modal="modal-paste-json">Cancel</button>
                    <button id="btn-process-paste" class="btn btn-primary">Import Pasted JSON</button>
                </div>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
